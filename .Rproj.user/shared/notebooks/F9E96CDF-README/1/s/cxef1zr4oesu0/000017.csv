"0","weekly_df <- weekly_df %>%"
"0","    mutate(returns = TRI/lag(TRI)-1)"
"0",""
"0",""
"0","cumulative_return_with_fees <- function(df, bps, time_frame){"
"0","    net <- paste0(""net_return_bps"", bps)"
"0","    fees <- paste0(""fees_bps"", bps)"
"0",""
"0",""
"0","    monthly_fee <- (bps / 10000) / time_frame"
"0",""
"0","    df <- df %>% mutate(!!net := coalesce(returns,0) - monthly_fee,"
"0","                        !!fees := cumprod(1 + !!sym(net)))"
"0",""
"0",""
"0","    }"
"0",""
"0","weekly_df_2002 <- cumulative_return_with_fees(df = weekly_df, bps = 10, time_frame = 52)"
"0","weekly_df_2002 <- cumulative_return_with_fees(df = weekly_df, bps = 50, time_frame = 52)"
"0","weekly_df_2002 <- cumulative_return_with_fees(df = weekly_df, bps = 100, time_frame = 52)"
"0","weekly_df_2002 <- cumulative_return_with_fees(df = weekly_df, bps = 200, time_frame = 52)"
"0","weekly_df_2002 <- cumulative_return_with_fees(df = weekly_df, bps = 250, time_frame = 52)"
"0","weekly_df_2002 <- cumulative_return_with_fees(df = weekly_df, bps = 350, time_frame = 52)"
"0",""
"0","weekly_df_2010 <- weekly_df %>%"
"0","    filter(date >= as.Date(""2010-01-01"")) %>%"
"0","    cumulative_return_with_fees(df = ., bps = 10, time_frame = 52)"
"0","weekly_df_2010 <- cumulative_return_with_fees(df = weekly_df_2010, bps = 50, time_frame = 52)"
"0","weekly_df_2010 <- cumulative_return_with_fees(df = weekly_df_2010, bps = 100, time_frame = 52)"
"0","weekly_df_2010 <- cumulative_return_with_fees(df = weekly_df_2010, bps = 200, time_frame = 52)"
"0","weekly_df_2010 <- cumulative_return_with_fees(df = weekly_df_2010, bps = 250, time_frame = 52)"
"0","weekly_df_2010 <- cumulative_return_with_fees(df = weekly_df_2010, bps = 350, time_frame = 52)"
