"0","graph_for_the_tyranny_of_fees <- function(year, cum_diff, tidy_dat, text_box_location_x, text_box_location_y){"
"0",""
"0","    final_value_of_1m_investment <- function(df, bps_val){"
"0","        x <- df %>%"
"0","            filter(bps == bps_val)%>%"
"0","            pull(cumulative_returns)"
"0",""
"0","        return(x)"
"0",""
"0","    }"
"0",""
"0","    bps_10 <- final_value_of_1m_investment(df = cum_diff, bps_val = ""fees_bps10"")"
"0","    bps_250 <- final_value_of_1m_investment(df = cum_diff, bps_val = ""fees_bps250"")"
"0","    bps_350 <- final_value_of_1m_investment(df = cum_diff, bps_val = ""fees_bps350"")"
"0","    label_text <- glue(""R1m invested in January {year} \n\u2022 10 BPS: R{round(bps_10,2)}m \n\u2022 250 BPS: R{round(bps_250,2)}m \n\u2022 350 BPS : R{round(bps_350,2)}m"")"
"0","    subtitle_text <- glue(""Investor Cumulative Returns Given Different Fees since {year}"")"
"0",""
"0","    p <- ggplot(tidy_dat)+"
"0","        geom_line(aes(x = date, y = cumulative_returns, color = bps), linewidth = 0.8, alpha = 0.7) +"
"0","        geom_text(data = cum_diff,"
"0","                  aes(x = date, y = cumulative_returns, label = difference, color = bps),"
"0","                  hjust = -0.1, size = 2, fontface = ""bold"") +"
"0","        annotate("
"0","            ""label"","
"0","            x = as.Date(text_box_location_x),"
"0","            y = text_box_location_y,"
"0","            label = label_text,"
"0","            hjust = 0,"
"0","            vjust = 1,"
"0","            size = 3,"
"0","            fill = ""white"","
"0","            color = ""black"","
"0","            label.size = 0.1"
"0","            ) +"
"0","        fmxdat::theme_fmx(title.size = ggpts(30),"
"0","                      subtitle.size = ggpts(28),"
"0","                      caption.size = ggpts(25),"
"0","                      CustomCaption = T) +"
"0","        fmxdat::fmx_cols() +"
"0","        labs(x = """", y = ""Cumulative Returns Given Fees"", caption = ""Note:\nData from fmxdat package"","
"0","             title = ""Effect of Fees on Returns"","
"0","             subtitle = subtitle_text)"
"0",""
"0","    fmxdat::finplot(p, x.vert = T, x.date.type = ""%Y"", x.date.dist = ""1 years"")"
"0",""
"0","    return(p)"
"0",""
"0",""
"0","}"
